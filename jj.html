<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ç½‘é¡µç‰ˆå¤šæ®µè§†é¢‘å‰ªè¾‘å·¥å…·</title>
    <script src="./ffmpeg.min.js"></script>
    <style>
      * {
        box-sizing: border-box;
        margin: 0;
        padding: 0;
        font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      }

      body {
        background: linear-gradient(135deg, #1a2a6c, #b21f1f, #fdbb2d);
        color: #fff;
        min-height: 100vh;
        padding: 20px;
        display: flex;
        flex-direction: column;
        align-items: center;
      }

      .container {
        width: 100%;
        max-width: 1200px;
        background: rgba(0, 0, 0, 0.7);
        backdrop-filter: blur(10px);
        border-radius: 20px;
        padding: 30px;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
        margin-top: 20px;
      }

      header {
        text-align: center;
        margin-bottom: 30px;
      }

      h1 {
        font-size: 2.8rem;
        margin-bottom: 10px;
        background: linear-gradient(to right, #ff9966, #ff5e62);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        text-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
      }

      .subtitle {
        font-size: 1.2rem;
        color: #ddd;
        margin-bottom: 30px;
      }

      .panels {
        display: flex;
        gap: 25px;
        margin-bottom: 30px;
      }

      .panel {
        flex: 1;
        background: rgba(30, 30, 40, 0.85);
        border-radius: 15px;
        padding: 25px;
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
      }

      .panel-title {
        font-size: 1.5rem;
        margin-bottom: 20px;
        color: #4facfe;
        display: flex;
        align-items: center;
      }

      .panel-title i {
        margin-right: 10px;
        font-size: 1.8rem;
      }

      .file-upload {
        border: 2px dashed #5d9cec;
        border-radius: 10px;
        padding: 30px;
        text-align: center;
        transition: all 0.3s ease;
        margin-bottom: 20px;
        cursor: pointer;
      }

      .file-upload:hover {
        background: rgba(93, 156, 236, 0.1);
        transform: translateY(-3px);
      }

      .file-upload p {
        margin: 15px 0;
        font-size: 1.1rem;
      }

      .video-preview {
        width: 100%;
        background: #000;
        border-radius: 10px;
        overflow: hidden;
        margin-top: 15px;
      }

      video {
        width: 100%;
        max-height: 300px;
        display: block;
      }

      .segment-form {
        display: flex;
        gap: 15px;
        margin-bottom: 20px;
        flex-wrap: wrap;
        align-items: flex-end;
      }

      .form-group {
        flex: 1;
        min-width: 150px;
      }

      label {
        display: block;
        margin-bottom: 8px;
        color: #aaa;
      }

      input {
        width: 100%;
        padding: 12px;
        background: rgba(255, 255, 255, 0.1);
        border: 1px solid #444;
        border-radius: 8px;
        color: white;
        font-size: 1rem;
      }

      button {
        background: linear-gradient(to right, #4facfe, #00f2fe);
        color: white;
        border: none;
        padding: 12px 25px;
        border-radius: 8px;
        cursor: pointer;
        font-weight: bold;
        transition: all 0.3s ease;
        font-size: 1rem;
        flex-shrink: 0;
      }

      button:hover {
        transform: translateY(-3px);
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
      }

      button:disabled {
        background: #666;
        cursor: not-allowed;
        transform: none;
        box-shadow: none;
      }

      .btn-primary {
        background: linear-gradient(to right, #ff9966, #ff5e62);
        padding: 14px 30px;
        font-size: 1.1rem;
      }

      .segments-list {
        background: rgba(20, 20, 30, 0.6);
        border-radius: 10px;
        padding: 15px;
        max-height: 200px;
        overflow-y: auto;
        margin-bottom: 20px;
      }

      .segment-item {
        display: flex;
        justify-content: space-between;
        padding: 12px;
        background: rgba(255, 255, 255, 0.05);
        border-radius: 8px;
        margin-bottom: 10px;
        align-items: center;
      }

      .segment-item:last-child {
        margin-bottom: 0;
      }

      .segment-times {
        font-weight: bold;
        color: #4facfe;
      }

      .segment-actions button {
        padding: 6px 12px;
        font-size: 0.9rem;
        background: rgba(255, 90, 90, 0.7);
      }

      .progress-container {
        margin: 25px 0;
      }

      .progress-bar {
        height: 12px;
        background: rgba(255, 255, 255, 0.1);
        border-radius: 6px;
        overflow: hidden;
        margin-bottom: 10px;
      }

      .progress-fill {
        height: 100%;
        background: linear-gradient(to right, #4facfe, #00f2fe);
        width: 0%;
        transition: width 0.3s ease;
      }

      .progress-text {
        text-align: center;
        font-size: 0.9rem;
        color: #aaa;
      }

      .actions {
        display: flex;
        justify-content: center;
        gap: 20px;
        margin-top: 20px;
      }

      .result-panel {
        text-align: center;
      }

      .status-message {
        min-height: 30px;
        margin: 15px 0;
        color: #4facfe;
        font-weight: bold;
      }

      .error-message {
        color: #ff5e62;
        margin: 15px 0;
        min-height: 30px;
      }

      .instructions {
        background: rgba(30, 30, 40, 0.85);
        border-radius: 15px;
        padding: 20px;
        margin-top: 30px;
      }

      .instructions h3 {
        color: #00f2fe;
        margin-bottom: 15px;
      }

      .instructions ol {
        padding-left: 20px;
        margin-bottom: 15px;
      }

      .instructions li {
        margin-bottom: 10px;
        line-height: 1.6;
      }

      footer {
        margin-top: 30px;
        text-align: center;
        color: #aaa;
        font-size: 0.9rem;
      }

      @media (max-width: 768px) {
        .panels {
          flex-direction: column;
        }

        .segment-form {
          flex-direction: column;
          align-items: stretch;
        }

        .actions {
          flex-direction: column;
          align-items: center;
        }
      }
    </style>
  </head>
  <body>
    <header>
      <h1>ç½‘é¡µç‰ˆå¤šæ®µè§†é¢‘å‰ªè¾‘å·¥å…·</h1>
      <p class="subtitle">åŸºäº FFmpeg.wasm æŠ€æœ¯ - ç›´æ¥åœ¨æµè§ˆå™¨ä¸­å®Œæˆè§†é¢‘å‰ªè¾‘</p>
    </header>

    <div class="container">
      <div class="panels">
        <div class="panel">
          <h2 class="panel-title">ğŸ“ 1. ä¸Šä¼ è§†é¢‘æ–‡ä»¶</h2>
          <div class="file-upload" id="fileDropArea">
            <p>æ‹–æ”¾è§†é¢‘æ–‡ä»¶åˆ°æ­¤å¤„</p>
            <p>æˆ–</p>
            <input type="file" id="videoInput" accept="video/*,audio/*" />
          </div>

          <div id="originalPreview" class="video-preview">
            <p style="text-align: center; padding: 50px 0">è§†é¢‘é¢„è§ˆåŒº</p>
          </div>
        </div>

        <div class="panel">
          <h2 class="panel-title">âœ‚ï¸ 2. é€‰æ‹©å‰ªè¾‘ç‰‡æ®µ</h2>
          <div class="segment-form">
            <div class="form-group">
              <label for="startTime">å¼€å§‹æ—¶é—´ï¼ˆç§’ï¼‰</label>
              <input
                type="number"
                id="startTime"
                min="0"
                step="0.1"
                value="0"
              />
            </div>

            <div class="form-group">
              <label for="endTime">ç»“æŸæ—¶é—´ï¼ˆç§’ï¼‰</label>
              <input type="number" id="endTime" min="0" step="0.1" value="5" />
            </div>

            <button id="addSegment">æ·»åŠ ç‰‡æ®µ</button>
          </div>

          <h3>å·²æ·»åŠ ç‰‡æ®µï¼š</h3>
          <div class="segments-list" id="segmentsList">
            <p style="text-align: center; padding: 10px">æš‚æ— æ·»åŠ çš„ç‰‡æ®µ</p>
          </div>

          <div class="status-message" id="segmentStatus"></div>
          <div class="error-message" id="segmentError"></div>
        </div>
      </div>

      <div class="panel result-panel">
        <h2 class="panel-title">ğŸ¬ 3. ç”Ÿæˆå‰ªè¾‘ç»“æœ</h2>

        <div class="progress-container">
          <div class="progress-bar">
            <div class="progress-fill" id="progressFill"></div>
          </div>
          <div class="progress-text" id="progressText">å‡†å¤‡å°±ç»ª</div>
        </div>

        <div class="actions">
          <button id="processBtn" class="btn-primary" disabled>å¼€å§‹å‰ªè¾‘</button>
          <button id="downloadBtn" class="btn-primary" disabled>
            ä¸‹è½½ç»“æœ
          </button>
          <button id="resetBtn">é‡ç½®æ‰€æœ‰</button>
        </div>

        <div class="status-message" id="statusMessage"></div>
        <div class="error-message" id="errorMessage"></div>

        <div id="resultPreview" class="video-preview">
          <p style="text-align: center; padding: 50px 0">å‰ªè¾‘ç»“æœé¢„è§ˆåŒº</p>
        </div>
      </div>

      <div class="instructions">
        <h3>ä½¿ç”¨è¯´æ˜ï¼š</h3>
        <ol>
          <li>ä¸Šä¼ è§†é¢‘æˆ–éŸ³é¢‘æ–‡ä»¶ï¼ˆæ”¯æŒMP4ã€MOVã€AVIã€MP3ç­‰æ ¼å¼ï¼‰</li>
          <li>è®¾ç½®å‰ªè¾‘çš„å¼€å§‹æ—¶é—´å’Œç»“æŸæ—¶é—´ï¼ˆå•ä½ï¼šç§’ï¼‰ï¼Œç‚¹å‡»"æ·»åŠ ç‰‡æ®µ"</li>
          <li>å¯æ·»åŠ å¤šä¸ªä¸é‡å çš„æ—¶é—´ç‰‡æ®µï¼ˆç³»ç»Ÿä¼šè‡ªåŠ¨æ£€æµ‹å¹¶é˜»æ­¢é‡å ç‰‡æ®µï¼‰</li>
          <li>
            ç‚¹å‡»"å¼€å§‹å‰ªè¾‘"æŒ‰é’®å¤„ç†è§†é¢‘ï¼ˆå¤„ç†æ—¶é—´å–å†³äºè§†é¢‘å¤§å°å’Œç‰‡æ®µæ•°é‡ï¼‰
          </li>
          <li>å¤„ç†å®Œæˆåç‚¹å‡»"ä¸‹è½½ç»“æœ"ä¿å­˜å‰ªè¾‘åçš„è§†é¢‘</li>
        </ol>
        <p>
          æ³¨æ„ï¼šæœ¬å·¥å…·å®Œå…¨åœ¨æµè§ˆå™¨ä¸­è¿è¡Œï¼Œä¸ä¼šä¸Šä¼ æ‚¨çš„è§†é¢‘æ–‡ä»¶ï¼Œç¡®ä¿éšç§å®‰å…¨ã€‚
        </p>
      </div>
    </div>

    <footer>
      <p>åŸºäº FFmpeg.wasm æŠ€æœ¯å®ç° | å®Œå…¨åœ¨æµè§ˆå™¨ä¸­è¿è¡Œ | æ— éœ€ä¸Šä¼ åˆ°æœåŠ¡å™¨</p>
      <p>Â© 2025 ç½‘é¡µç‰ˆè§†é¢‘å‰ªè¾‘å·¥å…·</p>
    </footer>

    <script>
      // FFmpegå®ä¾‹
      let ffmpeg = null
      let inputFile = null
      let videoUrl = null
      let outputBlob = null
      let segments = []

      // DOMå…ƒç´ 
      const videoInput = document.getElementById('videoInput')
      const startTimeInput = document.getElementById('startTime')
      const endTimeInput = document.getElementById('endTime')
      const addSegmentBtn = document.getElementById('addSegment')
      const segmentsList = document.getElementById('segmentsList')
      const segmentStatus = document.getElementById('segmentStatus')
      const segmentError = document.getElementById('segmentError')
      const processBtn = document.getElementById('processBtn')
      const downloadBtn = document.getElementById('downloadBtn')
      const resetBtn = document.getElementById('resetBtn')
      const statusMessage = document.getElementById('statusMessage')
      const errorMessage = document.getElementById('errorMessage')
      const progressFill = document.getElementById('progressFill')
      const progressText = document.getElementById('progressText')
      const originalPreview = document.getElementById('originalPreview')
      const resultPreview = document.getElementById('resultPreview')

      // åˆå§‹åŒ–äº‹ä»¶ç›‘å¬
      function initEvents() {
        // æ–‡ä»¶ä¸Šä¼ å¤„ç†
        videoInput.addEventListener('change', handleFileUpload)

        // æ·»åŠ ç‰‡æ®µæŒ‰é’®
        addSegmentBtn.addEventListener('click', addSegment)

        // å¤„ç†æŒ‰é’®
        processBtn.addEventListener('click', processVideo)

        // ä¸‹è½½æŒ‰é’®
        downloadBtn.addEventListener('click', downloadResult)

        // é‡ç½®æŒ‰é’®
        resetBtn.addEventListener('click', resetAll)

        // æ‹–æ”¾åŠŸèƒ½
        const dropArea = document.getElementById('fileDropArea')
        dropArea.addEventListener('dragover', (e) => {
          e.preventDefault()
          dropArea.style.borderColor = '#4facfe'
          dropArea.style.backgroundColor = 'rgba(93, 156, 236, 0.2)'
        })

        dropArea.addEventListener('dragleave', () => {
          dropArea.style.borderColor = '#5d9cec'
          dropArea.style.backgroundColor = 'transparent'
        })

        dropArea.addEventListener('drop', (e) => {
          e.preventDefault()
          dropArea.style.borderColor = '#5d9cec'
          dropArea.style.backgroundColor = 'transparent'

          if (e.dataTransfer.files.length) {
            videoInput.files = e.dataTransfer.files
            handleFileUpload({ target: { files: e.dataTransfer.files } })
          }
        })
      }

      // å¤„ç†æ–‡ä»¶ä¸Šä¼ 
      function handleFileUpload(event) {
        const file = event.target.files[0]
        if (!file) return

        // æ£€æŸ¥æ–‡ä»¶ç±»å‹
        if (!file.type.match('video.*') && !file.type.match('audio.*')) {
          showError('è¯·ä¸Šä¼ è§†é¢‘æˆ–éŸ³é¢‘æ–‡ä»¶', errorMessage)
          return
        }

        inputFile = file
        videoUrl = URL.createObjectURL(file)

        // æ˜¾ç¤ºåŸè§†é¢‘é¢„è§ˆ
        originalPreview.innerHTML = `
                <video controls>
                    <source src="${videoUrl}" type="${file.type}">
                    æ‚¨çš„æµè§ˆå™¨ä¸æ”¯æŒè§†é¢‘é¢„è§ˆ
                </video>
                <p style="text-align: center; padding: 10px 0;">${
                  file.name
                } (${formatFileSize(file.size)})</p>
            `

        // é‡ç½®ç‰‡æ®µåˆ—è¡¨
        segments = []
        updateSegmentsList()

        // å¯ç”¨å¤„ç†æŒ‰é’®
        processBtn.disabled = false
        downloadBtn.disabled = true
        segmentStatus.textContent = 'è¯·æ·»åŠ è¦å‰ªè¾‘çš„æ—¶é—´æ®µ'
      }

      // æ·»åŠ æ—¶é—´æ®µ
      function addSegment() {
        const start = parseFloat(startTimeInput.value)
        const end = parseFloat(endTimeInput.value)

        // éªŒè¯è¾“å…¥
        if (isNaN(start) || isNaN(end) || start < 0 || end < 0) {
          showError('è¯·è¾“å…¥æœ‰æ•ˆçš„æ—¶é—´å€¼', segmentError)
          return
        }

        if (start >= end) {
          showError('ç»“æŸæ—¶é—´å¿…é¡»å¤§äºå¼€å§‹æ—¶é—´', segmentError)
          return
        }

        if (!inputFile) {
          showError('è¯·å…ˆä¸Šä¼ è§†é¢‘æ–‡ä»¶', segmentError)
          return
        }

        // æ£€æŸ¥é‡å 
        for (const seg of segments) {
          if (
            (start >= seg.start && start < seg.end) ||
            (end > seg.start && end <= seg.end) ||
            (start <= seg.start && end >= seg.end)
          ) {
            showError(
              `æ—¶é—´æ®µä¸å·²æ·»åŠ çš„ç‰‡æ®µ (${seg.start}s-${seg.end}s) é‡å `,
              segmentError
            )
            return
          }
        }

        // æ·»åŠ æ–°ç‰‡æ®µ
        segments.push({ start, end })
        segments.sort((a, b) => a.start - b.start)

        updateSegmentsList()
        segmentStatus.textContent = `å·²æ·»åŠ ç‰‡æ®µ: ${start}s - ${end}s`
        segmentError.textContent = ''

        // æ¸…ç©ºè¾“å…¥
        startTimeInput.value = ''
        endTimeInput.value = ''
      }

      // æ›´æ–°ç‰‡æ®µåˆ—è¡¨æ˜¾ç¤º
      function updateSegmentsList() {
        if (segments.length === 0) {
          segmentsList.innerHTML =
            '<p style="text-align: center; padding: 10px;">æš‚æ— æ·»åŠ çš„ç‰‡æ®µ</p>'
          return
        }

        segmentsList.innerHTML = ''
        segments.forEach((seg, index) => {
          const segElement = document.createElement('div')
          segElement.className = 'segment-item'
          segElement.innerHTML = `
                    <div class="segment-times">${
                      index + 1
                    }. ${seg.start.toFixed(1)}s - ${seg.end.toFixed(1)}s</div>
                    <div class="segment-actions">
                        <button data-index="${index}">åˆ é™¤</button>
                    </div>
                `
          segmentsList.appendChild(segElement)
        })

        // æ·»åŠ åˆ é™¤æŒ‰é’®äº‹ä»¶
        document.querySelectorAll('.segment-actions button').forEach((btn) => {
          btn.addEventListener('click', (e) => {
            const index = parseInt(e.target.getAttribute('data-index'))
            segments.splice(index, 1)
            updateSegmentsList()
            segmentStatus.textContent = 'ç‰‡æ®µå·²åˆ é™¤'
          })
        })
      }

      // å¤„ç†è§†é¢‘å‰ªè¾‘
      async function processVideo() {
        if (!inputFile || segments.length === 0) {
          showError('è¯·ä¸Šä¼ æ–‡ä»¶å¹¶æ·»åŠ è‡³å°‘ä¸€ä¸ªå‰ªè¾‘ç‰‡æ®µ', errorMessage)
          return
        }

        // åˆå§‹åŒ–FFmpeg
        try {
          statusMessage.textContent = 'æ­£åœ¨åŠ è½½FFmpegå¼•æ“...'
          errorMessage.textContent = ''
          processBtn.disabled = true
          downloadBtn.disabled = true

          if (!ffmpeg) {
            const { createFFmpeg, fetchFile } = FFmpeg
            ffmpeg = createFFmpeg({
              log: true,
              //   corePath: './ffmpeg-core.js',
              //   wasmPath: './ffmpeg-core.wasm',
              //   workerPath: './ffmpeg-core.worker.js',
            })

            // ç›‘å¬æ—¥å¿—è¾“å‡ºä»¥è·å–è¿›åº¦
            ffmpeg.setLogging(({ message }) => {
              if (message.startsWith('frame=')) {
                const match = message.match(/time=(\d+:\d+:\d+\.\d+)/)
                if (match) {
                  const time = match[1]
                  progressText.textContent = `å¤„ç†ä¸­: ${time}`
                }
              }
            })

            // ç›‘å¬è¿›åº¦
            ffmpeg.setProgress(({ ratio }) => {
              const percent = Math.floor(ratio * 100)
              progressFill.style.width = `${percent}%`
              progressText.textContent = `å¤„ç†ä¸­: ${percent}%`
            })

            await ffmpeg.load()
          }

          statusMessage.textContent = 'æ­£åœ¨å¤„ç†è§†é¢‘...'
          const { fetchFile } = FFmpeg

          // å†™å…¥è§†é¢‘æ–‡ä»¶åˆ°è™šæ‹Ÿæ–‡ä»¶ç³»ç»Ÿ
          const inputName =
            'input.' + (inputFile.type.includes('audio') ? 'mp3' : 'mp4')
          ffmpeg.FS('writeFile', inputName, await fetchFile(inputFile))

          // æ„å»ºFFmpegå‘½ä»¤ - å¤šæ®µå‰ªè¾‘
          let filterComplex = ''
          segments.forEach((seg, i) => {
            filterComplex += `[0:v]trim=start=${seg.start}:end=${seg.end},setpts=PTS-STARTPTS[v${i}];`
            filterComplex += `[0:a]atrim=start=${seg.start}:end=${seg.end},asetpts=PTS-STARTPTS[a${i}];`
          })

          // è¿æ¥æ‰€æœ‰ç‰‡æ®µ
          filterComplex += segments.map((_, i) => `[v${i}][a${i}]`).join('')
          filterComplex += `concat=n=${segments.length}:v=1:a=1[outv][outa]`

          // æ‰§è¡ŒFFmpegå‘½ä»¤
          await ffmpeg.run(
            '-i',
            inputName,
            '-filter_complex',
            filterComplex,
            '-map',
            '[outv]',
            '-map',
            '[outa]',
            '-c:v',
            'libx264',
            '-c:a',
            'aac',
            'output.mp4'
          )

          // è¯»å–è¾“å‡ºæ–‡ä»¶
          const data = ffmpeg.FS('readFile', 'output.mp4')
          outputBlob = new Blob([data.buffer], { type: 'video/mp4' })
          const outputUrl = URL.createObjectURL(outputBlob)

          // æ˜¾ç¤ºç»“æœé¢„è§ˆ
          resultPreview.innerHTML = `
                    <video controls>
                        <source src="${outputUrl}" type="video/mp4">
                        æ‚¨çš„æµè§ˆå™¨ä¸æ”¯æŒè§†é¢‘é¢„è§ˆ
                    </video>
                `

          statusMessage.textContent = 'è§†é¢‘å¤„ç†å®Œæˆï¼'
          progressText.textContent = 'å¤„ç†å®Œæˆ'
          progressFill.style.width = '100%'
          downloadBtn.disabled = false
        } catch (error) {
          console.error('å¤„ç†å¤±è´¥:', error)
          showError(`å¤„ç†å¤±è´¥: ${error.message}`, errorMessage)
          processBtn.disabled = false
        }
      }

      // ä¸‹è½½ç»“æœ
      function downloadResult() {
        if (!outputBlob) {
          showError('æ²¡æœ‰å¯ä¸‹è½½çš„ç»“æœ', errorMessage)
          return
        }

        const a = document.createElement('a')
        a.href = URL.createObjectURL(outputBlob)
        a.download = `å‰ªè¾‘ç»“æœ_${new Date()
          .toISOString()
          .slice(0, 19)
          .replace(/:/g, '-')}.mp4`
        a.click()
      }

      // é‡ç½®æ‰€æœ‰
      function resetAll() {
        segments = []
        updateSegmentsList()

        if (videoUrl) {
          URL.revokeObjectURL(videoUrl)
          videoUrl = null
        }

        if (outputBlob) {
          URL.revokeObjectURL(URL.createObjectURL(outputBlob))
          outputBlob = null
        }

        videoInput.value = ''
        originalPreview.innerHTML =
          '<p style="text-align: center; padding: 50px 0;">è§†é¢‘é¢„è§ˆåŒº</p>'
        resultPreview.innerHTML =
          '<p style="text-align: center; padding: 50px 0;">å‰ªè¾‘ç»“æœé¢„è§ˆåŒº</p>'
        processBtn.disabled = true
        downloadBtn.disabled = true
        startTimeInput.value = '0'
        endTimeInput.value = '5'
        progressFill.style.width = '0%'
        progressText.textContent = 'å‡†å¤‡å°±ç»ª'
        statusMessage.textContent = ''
        errorMessage.textContent = ''
        segmentStatus.textContent = ''
        segmentError.textContent = ''
      }

      // è¾…åŠ©å‡½æ•°
      function showError(message, element) {
        element.textContent = message
        setTimeout(() => {
          element.textContent = ''
        }, 5000)
      }

      function formatFileSize(bytes) {
        if (bytes < 1024) return bytes + ' bytes'
        else if (bytes < 1048576) return (bytes / 1024).toFixed(1) + ' KB'
        else return (bytes / 1048576).toFixed(1) + ' MB'
      }

      // åˆå§‹åŒ–
      window.onload = initEvents
    </script>
  </body>
</html>
